<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="F. Guillaume Blanchet – Andrew MacDonald">
<meta name="dcterms.date" content="2025-05-05">

<title>Introduction – Modèles hiérarchiques pour les sciences de la vie</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Modèles hiérarchiques pour les sciences de la vie</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/bios2/hiermod" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-very-basic" id="toc-the-very-basic" class="nav-link active" data-scroll-target="#the-very-basic">The very basic</a>
  <ul class="collapse">
  <li><a href="#internet" id="toc-internet" class="nav-link" data-scroll-target="#internet">Internet</a></li>
  <li><a href="#dos-and-donts-at-jouvence" id="toc-dos-and-donts-at-jouvence" class="nav-link" data-scroll-target="#dos-and-donts-at-jouvence">Dos and don’ts at Jouvence</a></li>
  <li><a href="#course-material" id="toc-course-material" class="nav-link" data-scroll-target="#course-material">Course material</a></li>
  <li><a href="#statistiques-avancées-en-sciences-de-la-vie-bio709bio809" id="toc-statistiques-avancées-en-sciences-de-la-vie-bio709bio809" class="nav-link" data-scroll-target="#statistiques-avancées-en-sciences-de-la-vie-bio709bio809">Statistiques avancées en sciences de la vie (BIO709/BIO809)</a></li>
  <li><a href="#what-we-want-to-do-during-this-course" id="toc-what-we-want-to-do-during-this-course" class="nav-link" data-scroll-target="#what-we-want-to-do-during-this-course">What we want to do during this course</a></li>
  <li><a href="#what-we-want-to-do-during-this-course-1" id="toc-what-we-want-to-do-during-this-course-1" class="nav-link" data-scroll-target="#what-we-want-to-do-during-this-course-1">What we want to do during this course</a></li>
  <li><a href="#what-we-want-to-do-during-this-course-2" id="toc-what-we-want-to-do-during-this-course-2" class="nav-link" data-scroll-target="#what-we-want-to-do-during-this-course-2">What we want to do during this course</a></li>
  <li><a href="#what-we-want-to-do-during-this-course-3" id="toc-what-we-want-to-do-during-this-course-3" class="nav-link" data-scroll-target="#what-we-want-to-do-during-this-course-3">What we want to do during this course</a></li>
  <li><a href="#what-we-want-to-do-during-this-course-4" id="toc-what-we-want-to-do-during-this-course-4" class="nav-link" data-scroll-target="#what-we-want-to-do-during-this-course-4">What we want to do during this course</a></li>
  <li><a href="#course-general-structure" id="toc-course-general-structure" class="nav-link" data-scroll-target="#course-general-structure">Course general structure</a></li>
  <li><a href="#general-daily-schedule" id="toc-general-daily-schedule" class="nav-link" data-scroll-target="#general-daily-schedule">General daily schedule</a></li>
  </ul></li>
  <li><a href="#the-course-basics" id="toc-the-course-basics" class="nav-link" data-scroll-target="#the-course-basics">The course basics</a>
  <ul class="collapse">
  <li><a href="#what-are-hierarchical-models" id="toc-what-are-hierarchical-models" class="nav-link" data-scroll-target="#what-are-hierarchical-models">What are hierarchical models ?</a></li>
  <li><a href="#particularities-of-hierarchical-models" id="toc-particularities-of-hierarchical-models" class="nav-link" data-scroll-target="#particularities-of-hierarchical-models">Particularities of hierarchical models</a></li>
  <li><a href="#a-bit-of-vocabulary" id="toc-a-bit-of-vocabulary" class="nav-link" data-scroll-target="#a-bit-of-vocabulary">A bit of vocabulary</a></li>
  <li><a href="#a-bit-of-vocabulary-1" id="toc-a-bit-of-vocabulary-1" class="nav-link" data-scroll-target="#a-bit-of-vocabulary-1">A bit of vocabulary</a></li>
  <li><a href="#a-bit-of-vocabulary-2" id="toc-a-bit-of-vocabulary-2" class="nav-link" data-scroll-target="#a-bit-of-vocabulary-2">A bit of vocabulary</a></li>
  <li><a href="#a-bit-of-history" id="toc-a-bit-of-history" class="nav-link" data-scroll-target="#a-bit-of-history">A bit of history</a></li>
  <li><a href="#good-reference" id="toc-good-reference" class="nav-link" data-scroll-target="#good-reference">Good reference</a></li>
  <li><a href="#great-technical-references" id="toc-great-technical-references" class="nav-link" data-scroll-target="#great-technical-references">Great technical references</a></li>
  <li><a href="#implementation" id="toc-implementation" class="nav-link" data-scroll-target="#implementation">Implementation</a></li>
  <li><a href="#implementation-1" id="toc-implementation-1" class="nav-link" data-scroll-target="#implementation-1">Implementation</a></li>
  <li><a href="#r-and-stan" id="toc-r-and-stan" class="nav-link" data-scroll-target="#r-and-stan">R and Stan</a>
  <ul class="collapse">
  <li><a href="#rstudio" id="toc-rstudio" class="nav-link" data-scroll-target="#rstudio">RStudio</a></li>
  </ul></li>
  <li><a href="#r-package-to-install" id="toc-r-package-to-install" class="nav-link" data-scroll-target="#r-package-to-install">R package to install</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>F. Guillaume Blanchet – Andrew MacDonald </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 5, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="the-very-basic" class="level1">
<h1>The very basic</h1>
<section id="internet" class="level2">
<h2 class="anchored" data-anchor-id="internet">Internet</h2>
<p><strong>Network : jouvence </strong></p>
<p><strong>Password : Orford2021</strong></p>
</section>
<section id="dos-and-donts-at-jouvence" class="level2">
<h2 class="anchored" data-anchor-id="dos-and-donts-at-jouvence">Dos and don’ts at Jouvence</h2>
<p>. . .</p>
<p>Be respectful of the environment</p>
<p>. . .</p>
<p>Meals will be served at La Petite Auberge</p>
<p>. . .</p>
<p>You cannot consume your own beverages inside the main buildings. However, it will be permitted to bring your own drinks in certain outdoor areas, including around the fire pit in the evening.</p>
<p>. . .</p>
<p>Glass containers are not allowed</p>
<p>. . .</p>
<p>It is forbidden to smoke cannabis on site</p>
<p>. . .</p>
<p>More details can be found in this <strong><a href="https://docs.google.com/document/d/1i3rknFQdna6hMcS9J6c3EdD35Ol5EbPbTfidIHN8lc8/edit?tab=t.0">Google Doc</a></strong>.</p>
<p>. . .</p>
</section>
<section id="course-material" class="level2">
<h2 class="anchored" data-anchor-id="course-material">Course material</h2>
<p><strong>Website : <a href="https://bios2.github.io/hiermod/">https://bios2.github.io/hiermod/</a></strong></p>
<p>. . .</p>
<p>On it, you will find the slides but also practical examples.</p>
<p>. . .</p>
<p>You will also find the course syllabus</p>
<p>. . .</p>
<p>Here is a brief overview of the course</p>
</section>
<section id="statistiques-avancées-en-sciences-de-la-vie-bio709bio809" class="level2">
<h2 class="anchored" data-anchor-id="statistiques-avancées-en-sciences-de-la-vie-bio709bio809">Statistiques avancées en sciences de la vie (BIO709/BIO809)</h2>
<p>3 credits course at Université de Sherbrooke</p>
<p>. . .</p>
<p>It is a <strong>pass</strong> or <strong>fail</strong> course…</p>
<p>. . .</p>
<p>So, if you get involved, ask questions, try, work… you will pass.</p>
</section>
<section id="what-we-want-to-do-during-this-course" class="level2">
<h2 class="anchored" data-anchor-id="what-we-want-to-do-during-this-course">What we want to do during this course</h2>
<p>. . .</p>
<p><strong>Basic knowldege of statistics</strong></p>
<ul>
<li>General introduction</li>
<li>General overview of probability theory… for the life sciences</li>
<li>Probability distribution</li>
<li>Frequentist and Bayesian modelling</li>
<li>Data simulation (how and when)</li>
<li>Data simulation using different probability distribution</li>
</ul>
</section>
<section id="what-we-want-to-do-during-this-course-1" class="level2">
<h2 class="anchored" data-anchor-id="what-we-want-to-do-during-this-course-1">What we want to do during this course</h2>
<p><strong>Statistical computing</strong></p>
<ul>
<li>Introduction to Stan</li>
</ul>
<p>. . .</p>
<div style="color: red;font-size: 0.9em">
<p>We will <strong><em>not</em></strong> give an introduction to any programming language (e.g.&nbsp;R, Python, Julia).</p>
<p>We assume you know one and are conformtable using it… We are more comfortable in R, but can work with many other languages (but please no Fortran !)</p>
</div>
<p>. . .</p>
</section>
<section id="what-we-want-to-do-during-this-course-2" class="level2">
<h2 class="anchored" data-anchor-id="what-we-want-to-do-during-this-course-2">What we want to do during this course</h2>
<p><strong><em>Simple</em></strong> <strong>regression models</strong></p>
<ul>
<li>Refresher in matrix algebra</li>
<li>Refresher of linear model</li>
<li>Generalized linear model</li>
</ul>
<p><strong><em>Simple</em></strong> <strong>hierarchical regression models</strong></p>
<ul>
<li>Model with a single hierarchical component on the intercept</li>
<li>Model with a single hierarchical component on the slope</li>
</ul>
</section>
<section id="what-we-want-to-do-during-this-course-3" class="level2">
<h2 class="anchored" data-anchor-id="what-we-want-to-do-during-this-course-3">What we want to do during this course</h2>
<p><strong><em>Complexe</em></strong> <strong>hierarchical regression models</strong></p>
<ul>
<li>Model with multiple hierarchical terms</li>
<li>Model with multiple hierarchical levels</li>
<li>Hierarchical model with constraints</li>
<li>Gaussian process</li>
<li>Phylogenetic hierarchical models</li>
</ul>
</section>
<section id="what-we-want-to-do-during-this-course-4" class="level2">
<h2 class="anchored" data-anchor-id="what-we-want-to-do-during-this-course-4">What we want to do during this course</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[[-1], [1], [-1]]">
<div class="quarto-layout-row">
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>We also want to learn about your research… and this might influence what we see during the course !</p>
</div>
</div>
</div>
</section>
<section id="course-general-structure" class="level2">
<h2 class="anchored" data-anchor-id="course-general-structure">Course general structure</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-revealjs/unnamed-chunk-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="general-daily-schedule" class="level2">
<h2 class="anchored" data-anchor-id="general-daily-schedule">General daily schedule</h2>
<div style="font-size:35px">
<div style="color: blue;">
<p>7h00 to 8h30 - Breakfast</p>
</div>
<p>8h30 to 10h00 - Lecture/Practice</p>
<div style="color: orange;">
<p>10h00 to 10h30 - Break</p>
</div>
<p>10h30 to 12h30 - Lecture/Practice</p>
<div style="color: blue;">
<p>12h30 to 13h30 - Lunch</p>
</div>
<p>13h30 to 15h00 - Lecture/Practice</p>
<div style="color: orange;">
<p>15h30 to 16h00 - Break</p>
</div>
<p>16h00 to 17h00 - Lecture/Practice</p>
<p>17h00 to 17h30 - Let us know about your research !</p>
<div style="color: orange;">
<p>17h30 to 18h00 - Break</p>
</div>
<div style="color: blue;">
<p>18h00 to 19h00 - Supper</p>
</div>
</div>
</section>
</section>
<section id="the-course-basics" class="level1">
<h1>The course basics</h1>
<section id="what-are-hierarchical-models" class="level2">
<h2 class="anchored" data-anchor-id="what-are-hierarchical-models">What are hierarchical models ?</h2>
<p>For this course, hierarchical models are regression models in which the parameters (the regression coefficients) are not defined by a single value but they are themselves given a probability distribution (Gelman and Hill 2007).</p>
</section>
<section id="particularities-of-hierarchical-models" class="level2">
<h2 class="anchored" data-anchor-id="particularities-of-hierarchical-models">Particularities of hierarchical models</h2>
<p>Hierarchical models are</p>
<p>. . .</p>
<ul>
<li>A challenging bit of technology (probably more than you might think!)</li>
</ul>
<p>. . .</p>
<ul>
<li>Very flexible models (in many more ways that are usually expected!)</li>
</ul>
<p>. . .</p>
<ul>
<li>Constrained to the same particularities as (generalized) (non) linear models (sometimes to a more severe extent)</li>
</ul>
</section>
<section id="a-bit-of-vocabulary" class="level2">
<h2 class="anchored" data-anchor-id="a-bit-of-vocabulary">A bit of vocabulary</h2>
<p>. . .</p>
<p>Hierarchical models, as we will see them in this course, are also known under different names</p>
<p>. . .</p>
<ul>
<li>Random effect models</li>
</ul>
<p>. . .</p>
<ul>
<li>Mixed models</li>
</ul>
<p>. . .</p>
<ul>
<li>Multilevel models</li>
</ul>
<p>. . .</p>
<ul>
<li>Variance component models</li>
</ul>
<p>. . .</p>
<ul>
<li>Error component models</li>
</ul>
</section>
<section id="a-bit-of-vocabulary-1" class="level2">
<h2 class="anchored" data-anchor-id="a-bit-of-vocabulary-1">A bit of vocabulary</h2>
<p>We decided to use the term hierachical model to prevent confusions that sometimes arises in the litterature about <em>random</em> and <em>fixed</em> effects, which are terms commonly used when referring to mixed effect models.</p>
<p>. . .</p>
<p>Actually, <em>random</em> and <em>fixed</em> effects have multiple definitions, which leads to confusion.</p>
</section>
<section id="a-bit-of-vocabulary-2" class="level2">
<h2 class="anchored" data-anchor-id="a-bit-of-vocabulary-2">A bit of vocabulary</h2>
<p><strong>Multiple Definition of <em>fixed</em> and <em>random</em> effects</strong></p>
<p>. . .</p>
<div style="font-size: 0.8em">
<p><a href="https://methods.sagepub.com/book/introducing-multilevel-modeling">(Kreft and De Leeuw 1998)</a> <em>Fixed</em> effects are constant and <em>random</em> effect vary</p>
</div>
<p>. . .</p>
<div style="font-size: 0.8em">
<p><a href="https://onlinelibrary.wiley.com/doi/book/10.1002/9780470316856">(Searl et al.&nbsp;1992)</a> Effects are <em>fixed</em> if they are interesting in themselves or <em>random</em> if there is interest in the underlying population</p>
</div>
<p>. . .</p>
<div style="font-size: 0.8em">
<p><a href="https://link.springer.com/article/10.1007/BF02288577">(Green and Tukey 1960)</a> When a sample exhausts the population, the corresponding variable is <em>fixed</em>; when the sample is a small (i.e., negligible) part of the population the corresponding variable is <em>random</em></p>
</div>
<p>. . .</p>
<div style="font-size: 0.8em">
<p><a href="https://doi.org/10.1002/9781118445112.stat03169">(Roy LaMotte 2014)</a> If an effect is assumed to be a realized value of a random variable, it is called a <em>random</em> effect</p>
</div>
<p>. . .</p>
<div style="font-size: 0.8em">
<p><a href="https://www.jstor.org/stable/2245695">(Robinson 1991)</a> <em>Fixed</em> effects are estimated using least squares (or, more generally, maximum likelihood) and <em>random</em> effects are estimated with shrinkage.</p>
</div>
</section>
<section id="a-bit-of-history" class="level2">
<h2 class="anchored" data-anchor-id="a-bit-of-history">A bit of history</h2>
<p>. . .</p>
<p>Because of the different name used for hierarchial models, the history of this subfield of statistics is a little murky, but we know that a few important figures in statistics dabbed into this field, most notably</p>
<p>. . .</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/a/aa/Youngronaldfisher2.JPG" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:18.0%"></p>
</figure>
</div>
</div>
</div>
<div style="font-size: 0.5em">
<p>Fisher R.A. (1919). The Correlation between Relatives on the Supposition of Mendelian Inheritance. <em>Transactions of the Royal Society of Edinburgh</em>, <strong>52</strong> 399–433.</p>
</div>
</section>
<section id="good-reference" class="level2">
<h2 class="anchored" data-anchor-id="good-reference">Good reference</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://images.tandf.co.uk/common/jackets/crclarge/978042902/9780429029608.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:30.0%"></p>
</figure>
</div>
</div>
</div>
<p>A good portion of this course material is based on this book.</p>
</section>
<section id="great-technical-references" class="level2">
<h2 class="anchored" data-anchor-id="great-technical-references">Great technical references</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.booktopia.com.au/covers/big/9780521867061/5512/data-analysis-using-regression-and-multilevel-hierarchical-models.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:30.0%"></p>
</figure>
</div>
</div>
</div>
<p>Everything is there but it can gets technical !</p>
</section>
<section id="implementation" class="level2">
<h2 class="anchored" data-anchor-id="implementation">Implementation</h2>
<p>. . .</p>
<ul>
<li>Hierarchical models have been implemented in many software packages,</li>
</ul>
<p>. . .</p>
<ul>
<li>in R
<ul>
<li><code>lme4</code>, <code>brms</code>, <code>nlme</code>, <code>glmmTMB</code>, <code>MCMCglmm</code>, …</li>
</ul></li>
</ul>
<p>. . .</p>
<ul>
<li>in SAS
<ul>
<li><code>MIXED</code>, <code>HPMIXED</code>, <code>GLMMIX</code>, …</li>
</ul></li>
</ul>
<p>. . .</p>
<ul>
<li>in Julia
<ul>
<li><code>MixedModels.jl</code></li>
</ul></li>
<li>…</li>
</ul>
</section>
<section id="implementation-1" class="level2">
<h2 class="anchored" data-anchor-id="implementation-1">Implementation</h2>
<p><strong>What we will use</strong></p>
<p>. . .</p>
<p>We will not use any of these software packages because under specific circumstances, what may seem like the <strong>same</strong> implementation of a model may lead to different answers <span style="color: blue;"><strong>and both can actually be right !</strong></span></p>
<p>. . .</p>
<p>This is because the underlying model implemented in the software package may actually be slightly different.</p>
<p>. . .</p>
<p>Instead we will implement our own models from scratch using <span style="color: red;">Stan</span>.</p>
</section>
<section id="r-and-stan" class="level2">
<h2 class="anchored" data-anchor-id="r-and-stan">R and Stan</h2>
<p>All of the practical aspect of the course will be done with R and Stan.</p>
<p>. . .</p>
<section id="rstudio" class="level3">
<h3 class="anchored" data-anchor-id="rstudio">RStudio</h3>
<p>We strongly (!) encourage you to use RStudio and to start a project for the course.</p>
</section>
</section>
<section id="r-package-to-install" class="level2">
<h2 class="anchored" data-anchor-id="r-package-to-install">R package to install</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Package on CRAN</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"vegan"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"palmerpenguins"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"tidybayes"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"tidyverse"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"posterior"</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># run the next line if you already have rstan installed</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># remove.packages(c("StanHeaders", "rstan"))</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"rstan"</span>, <span class="at">repos =</span> <span class="fu">c</span>(<span class="st">'https://stan-dev.r-universe.dev'</span>, <span class="fu">getOption</span>(<span class="st">"repos"</span>)))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">example</span>(stan_model, <span class="at">package =</span> <span class="st">"rstan"</span>, <span class="at">run.dontrun =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->

<script>
  // htmlwidgets need to know to resize themselves when slides are shown/hidden.
  // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
  // slide changes (different for each slide format).
  (function () {
    // dispatch for htmlwidgets
    function fireSlideEnter() {
      const event = window.document.createEvent("Event");
      event.initEvent("slideenter", true, true);
      window.document.dispatchEvent(event);
    }

    function fireSlideChanged(previousSlide, currentSlide) {
      fireSlideEnter();

      // dispatch for shiny
      if (window.jQuery) {
        if (previousSlide) {
          window.jQuery(previousSlide).trigger("hidden");
        }
        if (currentSlide) {
          window.jQuery(currentSlide).trigger("shown");
        }
      }
    }

    // hookup for slidy
    if (window.w3c_slidy) {
      window.w3c_slidy.add_observer(function (slide_num) {
        // slide_num starts at position 1
        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
      });
    }

  })();
</script>

<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>