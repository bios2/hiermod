{
  "hash": "580c14c1809ad38c89c2ae6440c10699",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Stan\"\ntitle-slide-attributes: \n  data-background-image: ../img/bg.jpg\n  data-background-size: full\nauthor: \"Andrew MacDonald -- Guillaume Blanchet\"\ndate: \"2025-05-06\"\nexecute:\n  echo: true\nformat: \n  revealjs:\n    theme: [default]\n    logo: ../img/UdeS_logo_h_rgbHR.png\n    transition: slide\n    background-transition: fade\ninclude-in-header:\n  - text: |\n      <style>\n      .reveal .custom3070 > div.column:first-child {\n        width: 60%;\n      }\n      .reveal .custom3070 div.column:not(:first-child) {\n        width: 40%;\n      }\n      </style>\n---\n\n\n\n## What is the point of this?\n\n$$\n\\begin{equation}\nP(A|B) = \\frac{P(B|A) \\cdot P(A)}{P(B)}\n\\end{equation}\n$$\n\n\n## What is the point of this\n\n$$\n\\begin{equation}\nP(\\boldsymbol{\\theta}|\\text{data}) = \\frac{P(\\boldsymbol{\\text{data}|\\theta}) \\cdot P(\\boldsymbol{\\theta})}{P(\\text{data})}\n\\end{equation}\n$$\n\n## What is the point of this\n\n$$\n\\begin{equation}\nP(\\boldsymbol{\\theta}|\\text{data}) \\propto P(\\boldsymbol{\\text{data}|\\theta}) \\cdot P(\\boldsymbol{\\theta})\n\\end{equation}\n$$\n\n## What we talk about when we talk about $P(\\boldsymbol{\\text{data}|\\theta})$\n\nA concrete example\n\n\n| Laid   | Hatched |\n|--------|---------|\n| Egg 1  | Chick 1 |\n| Egg 2  | Chick 2 |\n| Egg 3  | Chick 3 |\n\n## What we talk about when we talk about $P(\\boldsymbol{\\text{data}|\\theta})$\n\nWhat's the probability of this dataset?  \nThis is called the _likelihood_\n\n$$\n\\begin{align}\n\\text{hatch} &\\sim \\text{Binomial}(p, 5) \\\\\n\\end{align}\n$$\n\n## What we talk about when we talk about $P(\\boldsymbol{\\text{data}|\\theta})$\n\n$$\n\\begin{align*}\n    P(3, 4, 5 | p) &= \\text{Binomial}(3 | p, 5) \\\\\n                   &\\quad \\times \\text{Binomial}(4 | p, 5) \\\\\n                   &\\quad \\times \\text{Binomial}(5 | p, 5)\n\\end{align*}\n$$\n\n## What we talk about when we talk about $P(\\boldsymbol{\\text{data}|\\theta})$\n\n$$\n\\begin{align*}\n    \\ln{P(3, 4, 5 | p)} &=  \\log(\\text{Binomial}(3 | p, 5)) \\\\\n                   &+  \\log(\\text{Binomial}(4 | p, 5)) \\\\\n                   &+ \\log(\\text{Binomial}(5 | p, 5))\n\\end{align*}\n$$\n\n\n## log-likelihood code in R \n\n\n\n::: {.cell .custom3070 output-location='column'}\n\n```{.r .cell-code}\nsurv <- c(3, 4, 5)\n\ncalc_ll <- function(x) {\n  res <- sum(-dbinom(surv, 5,\n                     prob = x,\n                     log = TRUE))\n  return(res)\n}\n\nprob_val <- seq(from = 0, to = 1,\n                length.out = 30)\nlog_lik <- numeric(30L)\n\nfor (i in 1:length(prob_val)) {\n  log_lik[i] <- calc_ll(prob_val[i])\n}\npar(cex = 3)\nplot(prob_val, log_lik, type = \"b\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-1-1.png){width=960}\n:::\n:::\n\n\n\n\n\n## Make it Bayes: add a prior\n\n\n$$\n\\begin{align}\n\\text{hatch} &\\sim \\text{Binomial}(p, 5) \\\\\np &\\sim \\text{Uniform}(0,1)\n\\end{align}\n$$\n\n\n## Make it Bayes: add a prior\n\n$$\n\\begin{align*}\nP(\\boldsymbol{\\theta}|\\text{data}) &\\propto P(\\boldsymbol{\\text{data}|\\theta}) \\cdot P(\\boldsymbol{\\theta}) \\\\[10pt]\n&\\propto \\text{Bin}(3|p,5) \\cdot \\text{Bin}(4|p,5) \\\\\n&\\qquad \\cdot \\text{Bin}(5|p,5)\\cdot \\text{Uniform}(p|0,1) \\\\[10pt]\n\\log(P(\\boldsymbol{\\theta}|\\text{data})) &\\propto \\log(\\text{Bin}(3|p,5)) + \\log(\\text{Bin}(4|p,5)) \\\\\n&\\qquad + \\log(\\text{Bin}(5|p,5)) + \\log(\\text{Uniform}(p|0,1)) \\\\\n\\end{align*}\n$$\n\n\n## Sampling the uncalculable\n\n:::: {layout=\"[ 40, 60 ]\"}\n\n::: {#first-column}\n![](https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/Operators_in_front_of_the_MANIAC.jpg/1920px-Operators_in_front_of_the_MANIAC.jpg)\n\nMANIAC I, 1956 (top) \nArianna W. Rosenbluth\n\n:::\n\n::: {#second-column}\n![](https://upload.wikimedia.org/wikipedia/commons/5/58/Arianna_W_Rosenbluth.jpg)\n:::\n\n::::\n\n\n\n## Sampling the uncalculable\n\n\n\n\n## What is Stan?\n<hr width=\"100%\" align=\"left\" size=\"0.3\" color=\"orange\"></hr>\n\n::: {layout-ncol=2}\n\n![](https://statmodeling.stat.columbia.edu/wp-content/uploads/2015/11/stan_logo.png)\n\n![StanisÅ‚aw Ulam](https://upload.wikimedia.org/wikipedia/commons/thumb/8/82/Stanislaw_Ulam.tif/lossy-page1-826px-Stanislaw_Ulam.tif.jpg){width=70%}\n\n:::\n\n## Stan\n\n[https://mc-stan.org/](https://mc-stan.org/)\n\n> A comprehensive software ecosystem aimed at facilitating the application of Bayesian inference\n\nFull Bayesian statistical inference with MCMC sampling (but not only)\n\nIntegrated with most data analysis languages (R, Python, MATLAB, Julia, Stata)\n\n\n## Why Stan?\n\n* Open source\n* Extensive documentation\n* Powerful sampling algorithm\n* Large and active online community!\n\n\n# Hamiltonian Monte Carlo (HMC)\n<hr width=\"100%\" align=\"left\" size=\"0.3\" color=\"orange\"></hr>\n\n## HMC\n\n:::{style=\"font-size: 0.8em\"}\nMetropolis and Gibbs limitations:\n\n- A lot of tuning to find the best spot between large and small steps\n- Inefficient in high-dimensional spaces\n- Can't travel long distances between isolated local minimums\n\n\n**Hamiltonian Monte Carlo**:\n\n- Uses a gradient-based MCMC to reduce the random walk (hence autocorrelation)\n\n- Static HMC\n\n- No-U-Turn Sampler (NUTS)\n\n- Don't get it? [Viz it!](https://arogozhnikov.github.io/2016/12/19/markov_chain_monte_carlo.html)\n:::\n\n## How to Stan\n\n![](../img/sucre.jpg){fig-align=\"center\"}\n\n## WHY to Stan\n\n::: {layout-ncol=2}\n\n![](../img/standiscourse.png)\n\n![](../img/whiteboard.png)\n\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}