{
  "hash": "6676ef1a86bd923d92347b2692e34052",
  "result": {
    "markdown": "---\ntitle: \"Introduction\"\ntitle-slide-attributes: \n  data-background-image: ../img/bg.jpg\n  data-background-size: full\nauthor: \"F. Guillaume Blanchet -- Andrew MacDonald\"\ndate: \"2024-04-29\"\nexecute:\n  echo: true\nformat: \n  revealjs:\n    theme: [default]\n    logo: ../img/UdeS_logo_h_rgbHR.png\n    transition: slide\n    background-transition: fade\n---\n\n\n# The very basic\n\n\n## Internet\n\n**Network : **\n\n**Password : **\n\n\n## Dos and don'ts at Jouvence\n\nKim will give us a quick explanation about this\n\n## Course material\n\n**Website : [https://bios2.github.io/hiermod/](https://bios2.github.io/hiermod/)**\n\n. . . \n\nOn it, you will find the slides but also practical examples.\n\n. . . \n\nYou will also find the course syllabus (in French)\n\n. . .\n\nHere is a brief overview of the course\n\n\n## Statistiques avancées en sciences de la vie (BIO709/BIO809)\n\n3 credits course at Université de Sherbrooke\n\n. . .\n\nIt is a **pass** or **fail** course... \n\n. . . \n\nSo, if you get involved, ask questions, try, work... you will pass.\n\n\n## What we want to do during this course\n\n. . .\n\n**Basic knowldege of statistics**\n\n- General introduction\n- General overview of probability theory... for the life sciences\n- Probability distribution\n- Frequentist and Bayesian modelling\n- Data simulation (how and when)\n- Data simulation using different probability distribution\n\n## What we want to do during this course\n\n**Statistical computing**\n\n- Introduction to Stan\n\n:::{style=\"color: red;font-size: 0.9em\"}\nWe will ***not*** give an introduction to any programming language (e.g. R, Python, Julia). \n\nWe assume you know one and are conformtable using it... We are more comfortable in R, but can work with many other languages (but please no Fortran !)\n:::\n\n\n## What we want to do during this course\n\n***Simple*** **regression models**\n\n- Refresher in matrix algebra\n- Refresher of linear model\n- Generalized linear model\n\n\n***Simple*** **hierarchical regression models**\n\n- Model with a single hierarchical component on the intercept\n- Model with a single hierarchical component on the slope\n\n## What we want to do during this course\n\n***Complexe*** **hierarchical regression models**\n\n- Model with multiple hierarchical terms\n- Model with multiple hierarchical levels\n- Hierarchical model with constraints\n- Gaussian process\n\n## What we want to do during this course\n\n:::{layout=\"[[-1], [1], [-1]]\"}\nWe also want to learn about your research... and this might influence what we see during the course !\n:::\n\n## Course general structure\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-1-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## General daily schedule\n\n::::{style=\"font-size:35px\"}\n\n:::{style=\"color: blue;\"}\n7h00 to 8h30 - Breakfast\n:::\n\n8h30 to 10h00 - Lecture/Practice\n\n:::{style=\"color: orange;\"}\n10h00 to 10h30 - Break\n:::\n\n10h30 to 12h30 - Lecture/Practice\n\n:::{style=\"color: blue;\"}\n12h30 to 13h30 - Lunch\n:::\n\n13h30 to 15h00 - Lecture/Practice\n\n:::{style=\"color: orange;\"}\n15h30 to 16h00 - Break\n:::\n\n16h00 to 17h00 - Lecture/Practice\n\n17h00 to 17h30 - Let us know about your research !\n\n:::{style=\"color: orange;\"}\n17h30 to 18h00 - Break\n:::\n\n:::{style=\"color: blue;\"}\n18h00 to 19h00 - Supper\n:::\n\n::::\n\n# The course basics\n\n## What are hierarchical models ?\n\nFor this course, hierarchical models are regression models in which the parameters (the regression coefficients) are not defined by a single value but they are themselves given a probability distribution (Gelman and Hill 2007). \n\n## Particularities of hierarchical models\n\nHierarchical models are\n\n. . .\n\n- A challenging bit of technology (probably more than you might think!) \n\n. . .\n\n- Very flexible models (in many more ways that are usually expected!)\n\n. . .\n\n- Constrained to the same particularities as (generalized) (non) linear models (sometimes to a more severe extent)\n\n## A bit of vocabulary\n\n. . .\n\nHierarchical models, as we will see them in this course, are also known under different names\n\n. . .\n\n  - Random effect models\n\n. . .\n\n  - Mixed models\n\n. . .\n\n  - Multilevel models\n\n. . .\n\n  - Variance component models\n\n. . .\n\n  - Error component models\n\n## A bit of vocabulary\n\nWe decided to use the term hierachical model to prevent confusions that sometimes arises in the litterature about *random* and *fixed* effects, which are terms commonly used when referring to mixed effect models. \n\n. . .\n\nActually, *random* and *fixed* effects have multiple definitions, which leads to confusion.\n\n## A bit of vocabulary\n\n**Multiple Definition of *fixed* and *random* effects**\n\n. . .\n\n::: {style=\"font-size: 0.8em\"}\n[(Kreft and De Leeuw 1998)](https://methods.sagepub.com/book/introducing-multilevel-modeling) *Fixed* effects are constant and *random* effect vary\n:::\n\n. . .\n\n::: {style=\"font-size: 0.8em\"}\n[(Searl et al. 1992)](https://onlinelibrary.wiley.com/doi/book/10.1002/9780470316856) Effects are *fixed* if they are interesting in themselves or *random* if there is interest in the underlying population\n:::\n\n. . .\n\n::: {style=\"font-size: 0.8em\"}\n[(Green and Tukey 1960)](https://link.springer.com/article/10.1007/BF02288577) When a sample exhausts the population, the corresponding variable is *fixed*; when the sample is a small (i.e., negligible) part of the population the corresponding variable is *random*\n:::\n\n. . .\n\n::: {style=\"font-size: 0.8em\"}\n[(Roy LaMotte 2014)](https://doi.org/10.1002/9781118445112.stat03169) If an effect is assumed to be a realized value of a random variable, it is called a *random* effect\n:::\n\n. . .\n\n::: {style=\"font-size: 0.8em\"}\n[(Robinson 1991)](https://www.jstor.org/stable/2245695) *Fixed* effects are estimated using least squares (or, more generally, maximum likelihood) and *random* effects are estimated with shrinkage. \n:::\n\n## A bit of history\n\n. . . \n\nBecause of the different name used for hierarchial models, the history of this subfield of statistics is a little murky, but we know that a few important figures in statistics dabbed into this field, most notably\n\n. . .\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](https://upload.wikimedia.org/wikipedia/commons/a/aa/Youngronaldfisher2.JPG){fig-align='center' width=18%}\n:::\n:::\n\n::: {style=\"font-size: 0.5em\"}\nFisher R.A. (1919). The Correlation between Relatives on the Supposition of Mendelian Inheritance. *Transactions of the Royal Society of Edinburgh*, **52** 399--433.\n:::\n\n## Implementation\n\n. . .\n\n- Hierarchical models have been implemented in many software packages,\n\n. . .\n\n  - in R \n    - `lme4`, `brms`, `nlme`, `glmmTMB`, `MCMCglmm`, ...\n\n. . .\n\n  - in SAS\n    - `MIXED`, `HPMIXED`, `GLMMIX`, ...\n\n. . .\n\n  - in Julia\n    - `MixedModels.jl`\n  - ...\n\n## Implementation\n\n**What we will use**\n\n. . .\n\nWe will not use any of these software packages because under specific circumstances, what may seem like the **same** implementation of a model may lead to different answers [**and both can actually be right !**]{style=\"color: blue;\"}\n\n. . .\n\nThis is because the underlying model implemented in the software package may actually be slightly different.\n\n. . .\n\nInstead we will implement our own models from scratch using [Stan]{style=\"color: red;\"}.\n\n## Good reference\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](https://images.tandf.co.uk/common/jackets/crclarge/978042902/9780429029608.jpg){fig-align='center' width=30%}\n:::\n:::\n\n\nA good portion of this course material is based on this book.\n\n\n## Great technical references\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](https://www.booktopia.com.au/covers/big/9780521867061/5512/data-analysis-using-regression-and-multilevel-hierarchical-models.jpg){fig-align='center' width=30%}\n:::\n:::\n\n\nEverything is there but it can gets technical !\n\n\n## R and Stan\n\nAll of the practical aspect of the course will be done with R and Stan.\n\n. . .\n\n### RStudio\n\nWe strongly (!) encourage you to use RStudio and to start a project for the course.\n\n\n## R package to install\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Package on CRAN\ninstall.packages(c(\"vegan\",\n                   \"palmerpenguins\",\n                   \"tidybayes\",\n                   \"tidyverse\",\n                   \"posterior\"))\n\n# cmdstanr - One last important package\ninstall.packages(\"cmdstanr\",\n                 repos = c(\"https://mc-stan.org/r-packages/\",\n                           getOption(\"repos\")))\ncmdstanr::check_cmdstan_toolchain()\ncmdstanr::install_cmdstan(cores = 2) # If necessary\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}